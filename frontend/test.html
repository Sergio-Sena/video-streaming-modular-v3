<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste Local - Video Streaming SStech</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .test-container { max-width: 800px; margin: 0 auto; }
        .test-section { background: #2a2a2a; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .status { padding: 10px; border-radius: 5px; margin: 10px 0; }
        .success { background: #28a745; }
        .error { background: #dc3545; }
        .warning { background: #ffc107; color: black; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .test-btn { background: #007bff; color: white; }
        .main-btn { background: #28a745; color: white; }
        pre { background: #1a1a1a; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Teste Local - Refatora√ß√£o Modular</h1>
        
        <div class="test-section">
            <h2>üìã Status dos M√≥dulos</h2>
            <div id="moduleStatus"></div>
        </div>

        <div class="test-section">
            <h2>üîó Teste de Conectividade</h2>
            <button class="test-btn" onclick="testAPI()">Testar API AWS</button>
            <button class="test-btn" onclick="testModules()">Testar M√≥dulos JS</button>
            <div id="connectivityResults"></div>
        </div>

        <div class="test-section">
            <h2>üéÆ A√ß√µes de Teste</h2>
            <button class="main-btn" onclick="openMainApp()">Abrir App Principal</button>
            <button class="test-btn" onclick="testLogin()">Simular Login</button>
            <button class="test-btn" onclick="testPlayer()">Testar Player</button>
        </div>

        <div class="test-section">
            <h2>üìä Console de Debug</h2>
            <pre id="debugConsole">Aguardando testes...</pre>
        </div>
    </div>

    <script>
        let debugLog = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.push(`[${timestamp}] ${type.toUpperCase()}: ${message}`);
            document.getElementById('debugConsole').textContent = debugLog.slice(-10).join('\n');
        }

        function checkModules() {
            const modules = ['APIModule', 'AuthModule', 'VideosModule', 'PlayerModule'];
            const status = document.getElementById('moduleStatus');
            let html = '';

            modules.forEach(module => {
                const exists = window[module] !== undefined;
                const statusClass = exists ? 'success' : 'error';
                const statusText = exists ? '‚úÖ Carregado' : '‚ùå N√£o encontrado';
                html += `<div class="status ${statusClass}">${module}: ${statusText}</div>`;
            });

            status.innerHTML = html;
        }

        async function testAPI() {
            log('Testando conectividade com API AWS...');
            const results = document.getElementById('connectivityResults');
            
            try {
                const response = await fetch('https://4y3erwjgak.execute-api.us-east-1.amazonaws.com/prod/auth', {
                    method: 'OPTIONS'
                });
                
                if (response.ok) {
                    results.innerHTML = '<div class="status success">‚úÖ API AWS acess√≠vel</div>';
                    log('API AWS respondeu com sucesso', 'success');
                } else {
                    results.innerHTML = '<div class="status error">‚ùå API AWS com problemas</div>';
                    log('API AWS retornou erro: ' + response.status, 'error');
                }
            } catch (error) {
                results.innerHTML = '<div class="status error">‚ùå Erro de conex√£o com API</div>';
                log('Erro de conex√£o: ' + error.message, 'error');
            }
        }

        function testModules() {
            log('Testando carregamento dos m√≥dulos...');
            
            try {
                // Simular inicializa√ß√£o dos m√≥dulos
                if (typeof APIModule !== 'undefined') {
                    const api = new APIModule();
                    log('APIModule: Instanciado com sucesso', 'success');
                }
                
                log('Todos os m√≥dulos testados', 'success');
            } catch (error) {
                log('Erro ao testar m√≥dulos: ' + error.message, 'error');
            }
        }

        function openMainApp() {
            log('Abrindo aplica√ß√£o principal...');
            window.open('index.html', '_blank');
        }

        function testLogin() {
            log('Simulando processo de login...');
            // Simular dados de teste
            const testData = {
                email: 'sergiosenaadmin@sstech',
                password: 'sergiosena',
                mfaToken: '123456'
            };
            log('Dados de teste: ' + JSON.stringify(testData), 'info');
        }

        function testPlayer() {
            log('Testando m√≥dulo do player...');
            // Simular abertura do player
            log('Player: Funcionalidade de modal testada', 'success');
        }

        // Inicializar testes
        document.addEventListener('DOMContentLoaded', () => {
            log('P√°gina de teste carregada');
            checkModules();
        });
    </script>

    <!-- Carregar m√≥dulos para teste -->
    <script src="modules/api.js"></script>
    <script src="modules/auth.js"></script>
    <script src="modules/videos.js"></script>
    <script src="modules/player.js"></script>
</body>
</html>